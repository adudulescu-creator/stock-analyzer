<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>S&P 500 Stock Analyzer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 16px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-size: 24px;
            color: #1a202c;
            margin-bottom: 8px;
        }

        .subtitle {
            color: #718096;
            font-size: 14px;
            margin-bottom: 16px;
        }

        .warning-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }

        .warning-box h3 {
            color: #856404;
            font-size: 16px;
            margin-bottom: 8px;
        }

        .warning-box p {
            color: #856404;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .warning-box a {
            color: #0066cc;
            text-decoration: underline;
        }

        .warning-box code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 13px;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        button {
            flex: 1;
            min-width: 140px;
            padding: 14px 20px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            touch-action: manipulation;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:active {
            background: #5568d3;
            transform: scale(0.98);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #2d3748;
        }

        .btn-secondary:active {
            background: #cbd5e0;
            transform: scale(0.98);
        }

        .stats {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 16px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            color: #718096;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #1a202c;
        }

        .stocks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
        }

        .stock-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }

        .stock-card:active {
            transform: scale(0.98);
        }

        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .stock-symbol {
            font-size: 20px;
            font-weight: 700;
            color: #1a202c;
        }

        .stock-name {
            font-size: 13px;
            color: #718096;
            margin-top: 2px;
        }

        .stock-price {
            font-size: 24px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 8px;
        }

        .stock-change {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
        }

        .positive {
            background: #c6f6d5;
            color: #22543d;
        }

        .negative {
            background: #fed7d7;
            color: #742a2a;
        }

        .stock-details {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e2e8f0;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .detail-label {
            color: #718096;
        }

        .detail-value {
            font-weight: 600;
            color: #1a202c;
        }

        .demo-note {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px;
            margin-top: 12px;
            border-radius: 4px;
            font-size: 13px;
            color: #1565c0;
        }

        @media (max-width: 640px) {
            body {
                padding: 12px;
            }

            h1 {
                font-size: 20px;
            }

            .header {
                padding: 20px;
            }

            .stocks-grid {
                grid-template-columns: 1fr;
            }

            button {
                min-width: 120px;
                padding: 12px 16px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä S&P 500 Stock Analyzer</h1>
            <div class="subtitle">Top 20 S&P 500 Stocks Monitor</div>
            
            <div class="warning-box">
                <h3>‚ö†Ô∏è Google Sites Limitation Detected</h3>
                <p><strong>Problem:</strong> Google Sites blocks external API calls due to CORS security restrictions. This prevents fetching live stock data directly from the page.</p>
                
                <p><strong>Solutions (choose one):</strong></p>
                <p><strong>Option 1 (Recommended):</strong> Download this HTML file and open it directly in your browser (not on Google Sites). It will work perfectly with real API data.</p>
                
                <p><strong>Option 2:</strong> Host on a different platform:
                <br>‚Ä¢ GitHub Pages (free, easy)
                <br>‚Ä¢ Netlify (free, drag & drop)
                <br>‚Ä¢ Your own web hosting</p>
                
                <p><strong>Option 3:</strong> Use the demo version below with simulated data (works on Google Sites but not real prices)</p>
                
                <div class="demo-note">
                    üí° <strong>Quick Test:</strong> Click "Load Demo Data" below to see how it works with sample data.
                </div>
            </div>

            <div class="controls">
                <button class="btn-primary" onclick="loadDemoData()">üìä Load Demo Data</button>
                <button class="btn-secondary" onclick="showInfo()">‚ÑπÔ∏è Info</button>
                <button class="btn-secondary" onclick="downloadAsFile()">‚¨áÔ∏è Download HTML</button>
            </div>
        </div>

        <div id="stats" class="stats" style="display: none;">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-label">Loaded</div>
                    <div class="stat-value" id="loadedCount">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Avg Change</div>
                    <div class="stat-value" id="avgChange">0%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Gainers</div>
                    <div class="stat-value" id="gainers">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Losers</div>
                    <div class="stat-value" id="losers">0</div>
                </div>
            </div>
        </div>

        <div id="stocks" class="stocks-grid"></div>
    </div>

    <script>
        const TOP_20_SP500 = [
            { symbol: 'AAPL', name: 'Apple Inc.', basePrice: 175 },
            { symbol: 'MSFT', name: 'Microsoft Corporation', basePrice: 380 },
            { symbol: 'NVDA', name: 'NVIDIA Corporation', basePrice: 495 },
            { symbol: 'AMZN', name: 'Amazon.com Inc.', basePrice: 155 },
            { symbol: 'GOOGL', name: 'Alphabet Inc.', basePrice: 140 },
            { symbol: 'META', name: 'Meta Platforms Inc.', basePrice: 350 },
            { symbol: 'TSLA', name: 'Tesla Inc.', basePrice: 245 },
            { symbol: 'BRK.B', name: 'Berkshire Hathaway', basePrice: 365 },
            { symbol: 'UNH', name: 'UnitedHealth Group', basePrice: 520 },
            { symbol: 'XOM', name: 'Exxon Mobil Corporation', basePrice: 110 },
            { symbol: 'JPM', name: 'JPMorgan Chase & Co.', basePrice: 155 },
            { symbol: 'JNJ', name: 'Johnson & Johnson', basePrice: 160 },
            { symbol: 'V', name: 'Visa Inc.', basePrice: 260 },
            { symbol: 'PG', name: 'Procter & Gamble', basePrice: 155 },
            { symbol: 'MA', name: 'Mastercard Inc.', basePrice: 420 },
            { symbol: 'HD', name: 'Home Depot Inc.', basePrice: 340 },
            { symbol: 'CVX', name: 'Chevron Corporation', basePrice: 155 },
            { symbol: 'MRK', name: 'Merck & Co. Inc.', basePrice: 105 },
            { symbol: 'ABBV', name: 'AbbVie Inc.', basePrice: 165 },
            { symbol: 'LLY', name: 'Eli Lilly and Company', basePrice: 580 }
        ];

        let stocksData = [];

        function loadDemoData() {
            const stats = document.getElementById('stats');
            const stocksContainer = document.getElementById('stocks');

            stocksContainer.innerHTML = '';
            stocksData = [];

            for (let stock of TOP_20_SP500) {
                const changePercent = (Math.random() - 0.5) * 8;
                const price = stock.basePrice * (1 + changePercent / 100);
                const change = price - stock.basePrice;
                
                const stockData = {
                    symbol: stock.symbol,
                    name: stock.name,
                    price: price,
                    change: change,
                    changePercent: changePercent,
                    volume: Math.floor(Math.random() * 80000000 + 20000000),
                    marketCap: price * (Math.random() * 800000000 + 500000000)
                };
                
                stocksData.push(stockData);
                displayStock(stockData);
            }

            stats.style.display = 'block';
            updateStats();
        }

        function displayStock(stock) {
            const stocksContainer = document.getElementById('stocks');
            const isPositive = stock.changePercent >= 0;
            
            const card = document.createElement('div');
            card.className = 'stock-card';
            card.innerHTML = `
                <div class="stock-header">
                    <div>
                        <div class="stock-symbol">${stock.symbol}</div>
                        <div class="stock-name">${stock.name}</div>
                    </div>
                </div>
                <div class="stock-price">$${stock.price.toFixed(2)}</div>
                <div class="stock-change ${isPositive ? 'positive' : 'negative'}">
                    ${isPositive ? '‚ñ≤' : '‚ñº'} ${Math.abs(stock.changePercent).toFixed(2)}%
                </div>
                <div class="stock-details">
                    <div class="detail-row">
                        <span class="detail-label">Change</span>
                        <span class="detail-value">${isPositive ? '+' : ''}$${stock.change.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Volume</span>
                        <span class="detail-value">${formatVolume(stock.volume)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Market Cap</span>
                        <span class="detail-value">${formatMarketCap(stock.marketCap)}</span>
                    </div>
                </div>
            `;
            
            stocksContainer.appendChild(card);
        }

        function updateStats() {
            const loaded = stocksData.length;
            const avgChange = stocksData.reduce((sum, s) => sum + s.changePercent, 0) / loaded;
            const gainers = stocksData.filter(s => s.changePercent > 0).length;
            const losers = stocksData.filter(s => s.changePercent < 0).length;

            document.getElementById('loadedCount').textContent = loaded;
            document.getElementById('avgChange').textContent = avgChange.toFixed(2) + '%';
            document.getElementById('avgChange').style.color = avgChange >= 0 ? '#22543d' : '#742a2a';
            document.getElementById('gainers').textContent = gainers;
            document.getElementById('losers').textContent = losers;
        }

        function formatVolume(volume) {
            if (volume >= 1000000000) return (volume / 1000000000).toFixed(2) + 'B';
            if (volume >= 1000000) return (volume / 1000000).toFixed(2) + 'M';
            if (volume >= 1000) return (volume / 1000).toFixed(2) + 'K';
            return volume.toString();
        }

        function formatMarketCap(marketCap) {
            const cap = parseFloat(marketCap);
            if (cap >= 1000000000000) return '$' + (cap / 1000000000000).toFixed(2) + 'T';
            if (cap >= 1000000000) return '$' + (cap / 1000000000).toFixed(2) + 'B';
            if (cap >= 1000000) return '$' + (cap / 1000000).toFixed(2) + 'M';
            return '$' + cap.toFixed(0);
        }

        function downloadAsFile() {
            // Create the full HTML with API integration
            const htmlContent = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S&P 500 Stock Analyzer - API Version</title>
    <style>${document.querySelector('style').textContent}</style>
</head>
<body>
    ${document.querySelector('.container').outerHTML.replace(/Load Demo Data|Download HTML/g, match => match === 'Load Demo Data' ? 'Refresh Real Data' : 'Info')}
    <script>
        // Full version with real API integration
        const API_KEY = 'YOUR_RAPIDAPI_KEY_HERE'; // Replace with your actual key
        
        const TOP_20_SP500 = ['AAPL','MSFT','NVDA','AMZN','GOOGL','META','TSLA','BRK-B','UNH','XOM','JPM','JNJ','V','PG','MA','HD','CVX','MRK','ABBV','LLY'];
        
        let stocksData = [];
        
        async function loadDemoData() {
            const stats = document.getElementById('stats');
            const stocksContainer = document.getElementById('stocks');
            stocksContainer.innerHTML = '<div style="text-align:center;padding:40px;color:#1a202c;background:white;border-radius:12px;">Loading real stock data...</div>';
            
            try {
                const symbolsParam = TOP_20_SP500.join(',');
                const url = \`https://apidojo-yahoo-finance-v1.p.rapidapi.com/market/v2/get-quotes?region=US&symbols=\${symbolsParam}\`;
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': API_KEY,
                        'X-RapidAPI-Host': 'apidojo-yahoo-finance-v1.p.rapidapi.com'
                    }
                });
                
                if (!response.ok) throw new Error('API Error: ' + response.status);
                
                const data = await response.json();
                stocksContainer.innerHTML = '';
                stocksData = [];
                
                for (const quote of data.quoteResponse.result) {
                    const stockData = {
                        symbol: quote.symbol,
                        name: quote.shortName || quote.symbol,
                        price: quote.regularMarketPrice || 0,
                        change: quote.regularMarketChange || 0,
                        changePercent: quote.regularMarketChangePercent || 0,
                        volume: quote.regularMarketVolume || 0,
                        marketCap: quote.marketCap || 0
                    };
                    stocksData.push(stockData);
                    displayStock(stockData);
                }
                
                stats.style.display = 'block';
                updateStats();
            } catch (err) {
                stocksContainer.innerHTML = '<div style="text-align:center;padding:40px;color:#c53030;background:white;border-radius:12px;">Error: ' + err.message + '<br><small>Make sure to replace YOUR_RAPIDAPI_KEY_HERE with your actual API key</small></div>';
            }
        }
        
        function displayStock(stock) {
            const stocksContainer = document.getElementById('stocks');
            const isPositive = stock.changePercent >= 0;
            const card = document.createElement('div');
            card.className = 'stock-card';
            card.innerHTML = \`
                <div class="stock-header">
                    <div>
                        <div class="stock-symbol">\${stock.symbol}</div>
                        <div class="stock-name">\${stock.name}</div>
                    </div>
                </div>
                <div class="stock-price">$\${stock.price.toFixed(2)}</div>
                <div class="stock-change \${isPositive ? 'positive' : 'negative'}">
                    \${isPositive ? '‚ñ≤' : '‚ñº'} \${Math.abs(stock.changePercent).toFixed(2)}%
                </div>
                <div class="stock-details">
                    <div class="detail-row">
                        <span class="detail-label">Change</span>
                        <span class="detail-value">\${isPositive ? '+' : ''}$\${stock.change.toFixed(2)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Volume</span>
                        <span class="detail-value">\${formatVolume(stock.volume)}</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Market Cap</span>
                        <span class="detail-value">\${formatMarketCap(stock.marketCap)}</span>
                    </div>
                </div>\`;
            stocksContainer.appendChild(card);
        }
        
        function updateStats() {
            const loaded = stocksData.length;
            const avgChange = stocksData.reduce((sum, s) => sum + s.changePercent, 0) / loaded;
            const gainers = stocksData.filter(s => s.changePercent > 0).length;
            const losers = stocksData.filter(s => s.changePercent < 0).length;
            document.getElementById('loadedCount').textContent = loaded;
            document.getElementById('avgChange').textContent = avgChange.toFixed(2) + '%';
            document.getElementById('avgChange').style.color = avgChange >= 0 ? '#22543d' : '#742a2a';
            document.getElementById('gainers').textContent = gainers;
            document.getElementById('losers').textContent = losers;
        }
        
        function formatVolume(volume) {
            if (volume >= 1000000000) return (volume / 1000000000).toFixed(2) + 'B';
            if (volume >= 1000000) return (volume / 1000000).toFixed(2) + 'M';
            if (volume >= 1000) return (volume / 1000).toFixed(2) + 'K';
            return volume.toString();
        }
        
        function formatMarketCap(marketCap) {
            const cap = parseFloat(marketCap);
            if (cap >= 1000000000000) return '$' + (cap / 1000000000000).toFixed(2) + 'T';
            if (cap >= 1000000000) return '$' + (cap / 1000000000).toFixed(2) + 'B';
            if (cap >= 1000000) return '$' + (cap / 1000000).toFixed(2) + 'M';
            return '$' + cap.toFixed(0);
        }
        
        function showInfo() {
            alert('S&P 500 Stock Analyzer\\n\\nThis version includes real API integration.\\n\\nTo use:\\n1. Get API key from rapidapi.com/apidojo/api/yahoo-finance1\\n2. Replace YOUR_RAPIDAPI_KEY_HERE in the code\\n3. Open this file in any browser');
        }
        
        window.addEventListener('load', loadDemoData);
    <\/script>
</body>
</html>`;

            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sp500-analyzer-with-api.html';
            a.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Downloaded!\n\nTo use with real data:\n1. Open the downloaded HTML file in a text editor\n2. Replace YOUR_RAPIDAPI_KEY_HERE with your actual API key\n3. Open it in any browser\n\nIt will fetch real stock prices!');
        }

        function showInfo() {
            alert('üìä S&P 500 Stock Analyzer\n\n' +
                  '‚ö†Ô∏è Google Sites CORS Limitation\n' +
                  'Google Sites blocks external API calls for security.\n\n' +
                  'Solutions:\n' +
                  '1. Download the HTML file (button above)\n' +
                  '2. Host on GitHub Pages, Netlify, or your server\n' +
                  '3. Use demo data (works on Google Sites)\n\n' +
                  'The downloaded version works with real Yahoo Finance data!');
        }

        // Auto-load demo data on page load
        window.addEventListener('load', loadDemoData);
    </script>
</body>
</html>
